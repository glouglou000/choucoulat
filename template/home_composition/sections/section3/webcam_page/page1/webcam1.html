<!-- web streams API polyfill to support Firefox -->
<script src="https://unpkg.com/@mattiasbuelens/web-streams-polyfill/dist/polyfill.min.js"></script>

<!-- ../libs/DBML.js to fix video seeking issues -->
<script src="https://www.webrtc-experiment.com/EBML.js"></script>

<!-- for Edge/FF/Chrome/Opera/etc. getUserMedia support -->
<script src="https://webrtc.github.io/adapter/adapter-latest.js"></script>
<script src="https://www.webrtc-experiment.com/DetectRTC.js"> </script>

<!-- video element -->

<script src="https://www.webrtc-experiment.com/getHTMLMediaElement.js"></script>


<!-- recommended -->
<script src="https://www.WebRTC-Experiment.com/RecordRTC.js"></script>

<!-- use 5.5.6 or any other version on cdnjs -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/RecordRTC/5.5.6/RecordRTC.js"></script>


<section class="sectionPage" id="section_page_webcam">

    <div class="DivVertical" id="verticalOne"></div>
    <div class="DivVertical" id="verticalTwo"></div>
    <div class="DivVertical" id="verticalThree"></div>


    <div class="Div"><!-- Top First Div -->

        <div class="divA" id="a1"><!-- Left Div -->


            <select class="recording-media" id="select1">
                <option value="record-audio-plus-video"
                    onclick="iconade('micam', 'icone_recording1', '')">Microphone et Camera</option>
 
                <option value="record-audio"
                    onclick="iconade('mic', 'icone_recording1', '')">Microphone</option>

                <option value="record-screen"
                    onclick="iconade('full', 'icone_recording1', '')">Full Screen</option>

                <option value="record-audio-plus-screen"
                    onclick="iconade('micfull', 'icone_recording1', '')">Microphone et Screen</option>
            </select>


            <div id="icone_recording1"></div>


        </div>


        <div class="divB">
            <select class="media-container-format" id="select2">
                <option onclick="iconade('1', 'icone_recording2', '')">default</option>
                <option onclick="iconade('2', 'icone_recording2', '')">vp8</option>
                <option onclick="iconade('3', 'icone_recording2', '')">vp9</option>
                <option onclick="iconade('4', 'icone_recording2', '')">h264</option>
                <option onclick="iconade('5', 'icone_recording2', '')">mkv</option>
                <option onclick="iconade('6', 'icone_recording2', '')">whammy</option>
            </select>

            <div id="icone_recording2"></div>

        </div>

        <div class="divC">

            <select class="media-container-format" id="select3">
                <option onclick="iconade('7', 'icone_recording3', '')">Applications</option>
                <option onclick="iconade('8', 'icone_recording3', 'eyes_tracking')">Eyes Tracking</option>
                <option onclick="iconade('9', 'icone_recording3', 'sleep')">Sleep and Car</option>
                <option onclick="iconade('10', 'icone_recording3', 'face')">Your Face</option>
                <option onclick="iconade('12', 'icone_recording3', 'test')">Just Test</option>
            </select>

            <div id="icone_recording3"></div>

            <div id="information_encoding">
                <p>
                    Votre navigateur est : <strong><span id="navigator_span"></span></strong>
                    <br><br>
                    <strong><span style="color:red;">Important :</span></strong> Nous vous prions de bien vouloir essayer<br>
                    la caméra avant de faire votre enregistrement avec <strong>les différents encodages</strong>.
                    <br><br>
                    <span>Recomandation: De face, une bonne qualité de caméra. Yeux bien visible.</span>
                </p>
            </div>


        </div>


    </div>


    <div class="Div">


        <div class="divA" id="a2"></div>


        <div class="divB">
            <div id="button_video">
                <button class="clio_button" id="Button_eye_application" onclick="to_video()">J'essaie la vidéo</button>
            </div>
            
        </div>

        <div class="divC"></div>

    </div>




    <div class="Div">

        <div class="divA" id="a3">
             <div class="explications" id="applications_explications_title"></div>
        </div>



        <div class="divB">
            <div class="explications" id="applications_explications"></div>
        </div>


        <div class="divC">


            <select class="media-resolutions" style="display:none;">
                <option value="default">Default resolutions</option>
                <option value="1920x1080">1080p</option>
                <option value="1280x720">720p</option>
                <option value="640x480">480p</option>
                <option value="3840x2160">4K Ultra HD (3840x2160)</option>
            </select>


            <select class="media-framerates" style="display:none;">
                <option value="default">Default framerates</option>
                <option value="5">5 fps</option>
                <option value="15">15 fps</option>
                <option value="24">24 fps</option>
                <option value="30">30 fps</option>
                <option value="60">60 fps</option>
            </select>


            <select class="media-bitrates" style="display:none;">
                <option value="default">Default bitrates</option>
                <option value="8000000000">1 GB bps</option>
                <option value="800000000">100 MB bps</option>
                <option value="8000000">1 MB bps</option>
                <option value="800000">100 KB bps</option>
                <option value="8000">1 KB bps</option>
                <option value="800">100 Bytes bps</option>
            </select>

            <div style="display: none">
                <input type="checkbox" id="chk-fixSeeking" style="margin:0;width:auto;display:none;" title="">
                <label for="chk-fixSeeking" style="font-size: 15px;margin:0;width: auto;
                cursor: pointer;-webkit-user-select:none;user-select:none;"
                title="Fix video seeking issues?"></label>
            </div>

            <div class="explications" id="applications_video"></div>


        </div>
    </div>




</section>



<style>
    .DivVertical{
        background-repeat   : no-repeat;
        background-position : center;
        background-size     : cover;
        opacity             : 1;
        -webkit-transition  : opacity 1s;
        -moz-transition     : opacity 1s;
        -o-transition       : opacity 1s;
        transition          : opacity 1s;
    }
    .sectionPage{
        position:absolute;
        width  :  100%;
        height : 100%;
        margin : 0;
        padding: 0;
    }
    .Div{
        height  : 33%;
        position: relative;
    }
    .divA{
        position : absolute;
        height   : 100%;
        width    : 33.3%;
        float    : left;
        opacity  : 1;
        -webkit-transition  : opacity 2s;
        -moz-transition     : opacity 2s;
        -o-transition       : opacity 2s;
        transition          : opacity 2s;
    }
    .divB{
        position   : absolute;
        height     : 100%;
        width      : 33.3%;
        margin-left: 33.3%;
    }
    .divC{
        position   : relative;
        height     : 100%;
        width      : 33.3%;
        margin-left: 66.6%;
        border     : 1px solid transparent;
    }
    .explications{
        color   : white;
    }
    .clio_button {
       color         : #FFFFFF !important;
       position      : relative;
       text-transform: initial !important;
       font-weight   : 500 !important;
       z-index       : 0;
       overflow      : hidden !important;
       transition    : transform 0s !important;
       font-family   : Arial;
       border        : none;
       outline       : 0;
    }
    .clio_button:hover {
        color : #FFFFFF;
    }
    .clio_button::before, .clio_button::after {
       content: "";
       position  : absolute;
       width     : 100%;
       height    : 100%;
       top       : 0;
       transition: left 0.6s cubic-bezier(0.22, 0.61, 0.36, 1);
    }
    .clio_button::before {
       background-color: #294C6B;
       z-index: -1;
       left: 0;
    }
    .clio_button::after {
       background-color: black;
       z-index: -1;
       left: 100%;
    }
    .clio_button:hover::before {
       left: -100%;
    }
    .clio_button:hover::after {
       left: 0;
    }
    .clio_button [class^="clio-"]::before {
        vertical-align: text-bottom;
    }
    .clio_button:active {
        transform: translateY(-2px);
    }



    #Button_eye_application{
        font-size:1.5em;
        border-radius:5px;
        z-index:500;
        opacity     :0;
        -webkit-transition: opacity 2s;
        -moz-transition   : opacity 2s;
        -o-transition     : opacity 2s;
        transition        : opacity 2s;
    }
    #button_video{
        width : 100%;
        height:100%;
        text-align:center;
        margin-top:20%;
    }
    #applications_explications_title{
        height    : 50%;
        text-align: center;
    }
    #applications_explications{
        height     : 50%;
        text-align : left;
    }
    #applications_video{
        height    : 100%;
        text-align: center;
    }
    #verticalOne{
        position        : absolute;
        width           : 33.3%;
        height          : 100%;
        background-image: url("/static/home_composition/section3/images/divc.jpg");


    }
    #verticalTwo{
        position        : absolute;
        background-image: url("/static/home_composition/section3/images/dive.jpg");
        width           : 33.3%;
        height          : 100%;
        margin-left     :33.3%;

    }
    #verticalThree{
        position        : absolute;
        background-image: url("/static/home_composition/section3/images/divd.jpg");
        width           : 33.3%;
        height          :100%;
        margin-left     :66.6%;


    }
    #icone_recording3{
        margin-top  : 15%;
        margin-left : -35%;
        opacity     : 1;
        width       : 10%;
        -webkit-transition  : opacity 2s;
        -moz-transition     : opacity 2s;
        -o-transition       : opacity 2s;
        transition          : opacity 2s;
        height:90;
    }
    #select3{
        position    : relative;
        margin-top  : 10%;
        margin-left : -70%;
        background  : transparent;
        outline     : 0;
        border      : none;
        float       : left;
        height      : 100%;
        overflow-y  : hidden;
        z-index     : 10;
        opacity     :0;
        -webkit-transition: opacity 2s;
        -moz-transition   : opacity 2s;
        -o-transition     : opacity 2s;
        transition        : opacity 2s;
        height            : 60%;
    }
    #information_encoding{
        position    : absolute;
        text-align  : left;
        margin-right : 5%;
        top: 15%;
        opacity     : 0;
        -webkit-transition : opacity 2s;
        -moz-transition    : opacity 2s;
        -o-transition      : opacity 2s;
        transition         : opacity 2s;
    }
    #icone_recording2{
        margin-top  : 15%;
        margin-left : 0%;
        opacity     : 1;
        height      : 90;
        width       : 10%;
        -webkit-transition: opacity 2s;
        -moz-transition   : opacity 2s;
        -o-transition     : opacity 2s;
        transition        : opacity 2s;
        position          : relative;
    }
    #select2{
        position    : relative;
        margin-top  : 10%;
        margin-left : -25%;
        background  : transparent;
        outline     : 0;
        border      : none;
        float       : left;
        overflow-y  : hidden;
        z-index     : 10;
        opacity     : 0;
        -webkit-transition  : opacity 2s;
        -moz-transition     : opacity 2s;
        -o-transition       : opacity 2s;
        transition          : opacity 2s;
    }
    #icone_recording1{
        position    : relative;
        margin-top  : 15%;
        margin-right: 25%;
        opacity     : 1;
        -webkit-transition  : opacity 2s;
        -moz-transition     : opacity 2s;
        -o-transition       : opacity 2s;
        transition          : opacity 2s;
    }
    #select1{
        position    : relative;
        margin-top  : 10%;
        margin-left : 5%;
        background  : transparent;
        outline     : 0;
        border      : none;
        float       : left;
        height      : 100%;
        overflow-y  : hidden;
        z-index     : 10;
        opacity     : 0;
        -webkit-transition : opacity 2s;
        -moz-transition    : opacity 2s;
        -o-transition      : opacity 2s;
        transition         : opacity 2s;
    }
    #section_page_webcam{
        /* background-image: url("/static/home_composition/section3/images/appareil_photo.jpg"); */
        background         : #7BAABE;
        background-repeat  : no-repeat;
        background-position: center;
        background-size    : cover;
        opacity     : 1;
        -webkit-transition : opacity 2s;
        -moz-transition    : opacity 2s;
        -o-transition      : opacity 2s;
        transition         : opacity 2s;
        z-index            : 100;
    }


</style>



<script>

    //Put Select div to size 5 and 6.
    document.getElementById("select1").size = "5";
    document.getElementById("select2").size = "6";
    document.getElementById("select3").size = "6";


    document.getElementById("container3").style.background = "#7BAABE";
    document.getElementById("section3_part2_part3").style.background = "#7BAABE";


    function explications_application(explication){

        dico = {

            "eyes_tracking" :["<h1>Eyes Tracking</h1>",
                              "Mais qu'est ce que l'utilisateur regarde en premier, ou dois-je mettre les éléments importants ?<br>\
                              et ceux moins utiles ? <br>\
                              Avec DLIB et opencv nous identifions le centre des pupilles et essayons de suivre leurs mouvements.<br>\
                              Puis nous les affichons à l'écran.",
                              "<img width='60%' src='static/home_composition/section3/images/eye_traking.gif'>"],

            "sleep":["<h1>Sleeping prevent</h1>",
                     "Pour éviter les risques de somnolence. Voici notre application.<br>\
                     Par openCV et DLIB nous identifions la position des yeux. Nous mesurons l'ouverture de ces derniers, et comptons le nombre\
                     de fermeture des yeux puis prevenons l'utisateur au volant.",
                     "<img width='60%' src='static/home_composition/section3/images/appli.gif'>"],

            "face":["<h1>Animate you're face</h1>",
                    "Quoi de mieux que de s'amuser ? <br>\
                    Animez votre visage, par example avec de gros yeux de poisson !\
                    Par DLIB et OpenCV nous identifions et localisons la position des yeux ainsi que leur fermeture\
                    puis appliquons des images a leur place.",
                    "<img width='60%' src='static/home_composition/section3/images/face.gif'>"],

            "test":["<h1>Just test</h1>",
                    "En identifions le centre de la pupille avec OpenCV et DLIB <br>\
                    Nous essayons de définir le mouvement de yeux que ce soit dans les différents quadrants (droit, gauche bas haut)<br>\
                    car le mouvements des yeux refletent ainsi la pensé\
                    ainsi que de leur fermture.",
                    "<img width='60%' src='static/home_composition/section3/images/appli.gif'>"],                    
        };


        document.getElementById("applications_explications_title").innerHTML = dico[explication][0];
        document.getElementById("applications_explications").innerHTML =dico[explication][1];
        document.getElementById("applications_video").innerHTML = dico[explication][2];
        CHOICE_APPLICATION = explication
    };


    document.getElementById("applications_explications_title").innerHTML = "<h1>Nos applications</h1>";
    document.getElementById("applications_explications").innerHTML = "Nos applications ont été fait a partir de DLIB ainsi qu'OpenCV.<br>\
                                                                    Attention elles sont loins d'etre parfaites et nécéssite plus d'expertise.\
                                                                    Nous esperons toutefois qu'elles vous plaieront!";
    document.getElementById("applications_video").innerHTML = "<img width='60%' src='static/home_composition/section3/images/appli.gif'>";










    //On click display an Icone.
    var CHOICE_APPLICATION = "";

    function iconade(icone, div, mode){

        document.getElementById(div).style.opacity = "0";

        if (mode != ''){
            explications_application(mode)
        };

        setTimeout(function()
        {

            dico = {"micam"  : '<img class="icone" width="40" src="https://img.icons8.com/material/24/000000/camera-on-tripod.png">',
                    "mic"    : '<img class="icone" width="35" src="https://img.icons8.com/ios-filled/50/000000/microphone.png">',
                    "full"   : '<img class="icone" width="45" src="https://img.icons8.com/ios-filled/50/000000/sdtv.png">',
                    "micfull": '<img class="icone" width="40" src="https://img.icons8.com/ios-filled/50/000000/add-record.png">',

                    "1" : '<img width="40" src="https://img.icons8.com/ios-filled/50/000000/word.png">',
                    "2" : '<img width="40" src="https://img.icons8.com/ios-filled/50/000000/ps.png">',
                    "3" : '<img width="40"  src="https://img.icons8.com/ios-filled/50/000000/binary-file.png">',
                    "4" : '<img width="40" src="https://img.icons8.com/ios-filled/50/000000/psd.png">',
                    "5" : '<img width="40" src="https://img.icons8.com/ios-filled/50/000000/powerpoint.png">',
                    "6" : '<img width="40" src="https://img.icons8.com/ios-filled/50/000000/python-file.png">',

                    "7" : '<img width="40" src="https://img.icons8.com/dotty/80/000000/playstore.png">',
                    "8" : '<img width="40" src="https://img.icons8.com/dotty/80/000000/web-design.png">',
                    "9" : '<img width="40" src="https://img.icons8.com/material-rounded/24/000000/sleepy-eyes.png">',
                    "10" : '<img width="40" src="https://img.icons8.com/ios-filled/50/000000/happy-eyes.png">',
                    "12" : '<img width="40" src="https://img.icons8.com/pastel-glyph/64/000000/test-partial-passed.png">'

            };

            document.getElementById(div).innerHTML = dico[icone];
            document.getElementById(div).style.opacity = "1";

        }, 900);
    };



    //First Animation Disapear.
    function animation_div_a_first_part(){

        //Fisrt div
        setTimeout(function(){
            document.getElementById("verticalOne").style.opacity = "0";
        }, 600)

        setTimeout(function(){
            document.getElementById("verticalTwo").style.opacity = "0";
        }, 1000)

        setTimeout(function(){
            document.getElementById("verticalThree").style.opacity = "0";
        }, 1400)
    };
    animation_div_a_first_part()



    //Second Animation Appear.
    function animation_div_a_second_part(){

        //Fisrt div
        setTimeout(function(){
            document.getElementById("verticalOne").style.display = "none";
            iconade("micam", "icone_recording1", "")
            document.getElementById("select1").style.opacity = "1";
        }, 1800) //1800

        setTimeout(function(){
            document.getElementById("verticalTwo").style.display = "none";
            iconade("1", "icone_recording2", "")
            document.getElementById("select2").style.opacity = "1";
            document.getElementById("information_encoding").style.opacity = "1";
        }, 2200) //2200

        setTimeout(function(){
            document.getElementById("verticalThree").style.display = "none";
            iconade("7", "icone_recording3", "")
            document.getElementById("select3").style.opacity = "1";
            document.getElementById("Button_eye_application").style.opacity = "1";
            
        }, 2600) //2600
    };
    animation_div_a_second_part()





    var browsers = ["Firefox","MSIE","Trident","Edge","Chrome","Safari", "Android"];

    var you_browsers = ""

    function getBrowser(bname) {
      var ua = navigator.userAgent;
      for(var b in browsers) {
        b = browsers[b];
          if(ua.indexOf(b) != -1) return b;
      }	
      return false;
    }

    var browser = getBrowser();
    if(browser == "Trident"|| browser=="MSIE") browser="IE/Edge";
    if (browser === false) {
      console.log("inconnue");
    } else {
      you_browsers =  browser;
    };



    function browsers_to_encodage(you_browsers){

        var encodage = ""

        if(you_browsers == "Chrome"){
            encodage = "VP8, VP9, H264, MKV ou Whammy"
        }else if(you_browsers == "Opera"){
            encodage = "VP8, VP9, H264 ou MKV"
        }else if(you_browsers == "Firefox"){
            encodage = "VP8 ou H264"
        }else if(you_browsers == "Safari"){
            encodage = "VP8"
        }else if(you_browsers == "Edge"){
            encodage = "None"
        };
        return encodage
    };

    encodage = browsers_to_encodage(you_browsers)
    document.getElementById("navigator_span").innerHTML = you_browsers + " utilisez :"  +  encodage;


    function to_video(){

        if (CHOICE_APPLICATION == ""){
            document.getElementById("Button_eye_application").innerHTML = "Choisir une appli";
        }
        else{
            document.getElementById("section_page_webcam").style.opacity = "0";

            setTimeout(function(){
                document.getElementById("section_page_webcam").style.display = "none";

                document.getElementById("section_page_webcam1").style.display = "block";
                document.getElementById("section_page_webcam1").style.opacity = "1";
            }, 2500)
            
        };
    };




</script>
